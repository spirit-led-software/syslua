{"id":"syslua-13q","title":"Implement standard pkgs system (builds without binds)","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-07T16:26:59.925081-05:00","created_by":"ianpascoe","updated_at":"2026-01-07T19:34:59.452126-05:00","closed_at":"2026-01-07T19:34:59.452126-05:00","close_reason":"Implementation complete and reviewed"}
{"id":"syslua-1du","title":"Handle directory outputs for bin/completions in environment.packages","description":"Spec says outputs.bin can be file OR directory. Current code only handles single files. Need to iterate directory contents.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T19:20:45.187452-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:27:10.547265-05:00","closed_at":"2026-01-08T19:27:10.547265-05:00","close_reason":"Fixed in packages.lua: portable sed pattern, atomic swap, directory output handling"}
{"id":"syslua-1e9","title":"Refactor existing packages to standardized output convention","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T18:27:51.960096-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.713506-05:00","closed_at":"2026-01-08T18:35:11.713506-05:00","close_reason":"Superseded by new plan syslua-ffg"}
{"id":"syslua-3dd","title":"Implement syslua.environment.packages - symlink forest core","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-08T18:27:48.395718-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.706259-05:00","closed_at":"2026-01-08T18:35:11.706259-05:00","close_reason":"Superseded by new plan syslua-ffg"}
{"id":"syslua-4sw","title":"user module: Windows scheduled task unregister may race with task completion","description":"Task polling has 300-second timeout but the finally block could race. Add brief delay before unregistration or wait for final state.\n\nFile reference: lua/syslua/user.lua:3175-3183","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-10T15:37:27.189298-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:27.189298-05:00"}
{"id":"syslua-630","title":"@diagnostic disable-next-line type bypasses","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T13:24:15.839272-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:31.212625-05:00","closed_at":"2026-01-10T13:24:31.212625-05:00","close_reason":"Fixed: Defined specific types (CreateCmdOpts, UpdateCmdOpts, etc.) to eliminate type bypasses"}
{"id":"syslua-6kf","title":"Input validation docs for defense in depth","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T13:24:14.806322-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:43.878812-05:00","closed_at":"2026-01-10T13:24:43.878812-05:00","close_reason":"Deferred: Nice-to-have documentation task, not blocking"}
{"id":"syslua-74i","title":"Phase 4: ctx:patch_rpath() build helper","description":"Register ctx:patch_rpath() via sys.register_build_ctx_method(). Patches ELF (Linux) and Mach-O (macOS) binaries to find libraries at store paths. Uses patchelf on Linux, install_name_tool on macOS. No-op on Windows. ~80 lines.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T18:34:47.996016-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:13:27.916552-05:00","closed_at":"2026-01-08T19:13:27.916552-05:00","close_reason":"Implemented in init.lua setup callback","dependencies":[{"issue_id":"syslua-74i","depends_on_id":"syslua-b27","type":"blocks","created_at":"2026-01-08T18:34:58.863771-05:00","created_by":"ianpascoe"}]}
{"id":"syslua-89k","title":"Silent failure in group_exists functions","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-10T13:24:16.152412-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:31.312081-05:00","closed_at":"2026-01-10T13:24:31.312081-05:00","close_reason":"Fixed: Added explicit error() calls when io.popen fails"}
{"id":"syslua-8i8","title":"Group management module","description":"## Summary\n\nCreate a group management module (`syslua.group`) following the same patterns as the user module. This will provide declarative cross-platform group management with CRUD operations, validation, and idempotent behavior.\n\n## Requirements\n\n### Core Functionality\n\n**Create**: Group creation with:\n- Group name\n- Description/comment (where supported)\n- GID specification (optional)\n- System group flag (optional)\n\n**Read**: Group existence checks via platform-specific commands:\n- Linux: `getent group \u003cgroupname\u003e` or `/etc/group`\n- macOS: `dscl . -read /Groups/\u003cgroupname\u003e`\n- Windows: PowerShell `Get-LocalGroup`\n\n**Update**: Idempotent updates for existing groups:\n- Description/comment updates (where supported)\n- Note: GID changes are generally not supported for safety\n\n**Delete**: Group removal with validation:\n- Check for existing members (optional warning)\n- Platform-specific removal commands\n\n### Architecture (following user module patterns)\n\n1. **Bind-Based Lifecycle Management**\n   - One bind per group with ID format: `__syslua_group_\u003cgroupname\u003e`\n   - `replace = true` for idempotent updates\n   - Two-phase lifecycle: create → destroy\n\n2. **Platform Abstraction**\n   - Separate command builders for Linux, macOS, Windows\n   - Single entry point dispatching based on `sys.os`\n   - Unified error handling\n\n3. **Priority-Based Configuration**\n   - Use `syslua.priority` module for option merging\n   - Support `syslua.Option\u003cT\u003e` types\n\n4. **Validation**\n   - Elevation check before operations\n   - Group existence validation\n   - Optional member validation\n\n### Type Definitions\n\n```lua\n---@class syslua.group.Options\n---@field description? syslua.Option\u003cstring\u003e\n---@field gid? syslua.Option\u003cnumber\u003e\n---@field system? syslua.Option\u003cboolean\u003e\n\n---@alias syslua.group.GroupMap table\u003cstring, syslua.group.Options\u003e\n```\n\n### Platform-Specific Implementation\n\n**Linux:**\n- Creation: `groupadd` with `-g` (GID), `-r` (system)\n- Update: `groupmod` (limited to renaming, which we won't support)\n- Deletion: `groupdel`\n\n**macOS:**\n- Creation: `dscl . -create /Groups/\u003cname\u003e` with PrimaryGroupID, RealName\n- Update: `dscl . -change /Groups/\u003cname\u003e`\n- Deletion: `dscl . -delete /Groups/\u003cname\u003e`\n\n**Windows:**\n- Creation: `New-LocalGroup -Name \u003cname\u003e -Description \u003cdesc\u003e`\n- Update: `Set-LocalGroup -Name \u003cname\u003e -Description \u003cdesc\u003e`\n- Deletion: `Remove-LocalGroup -Name \u003cname\u003e`\n\n### Public API\n\n```lua\nlocal group = require('syslua.group')\n\ngroup.setup({\n  developers = {\n    description = \"Development team\",\n    gid = 1001,\n  },\n  admins = {\n    description = \"System administrators\",\n    system = true,\n  },\n})\n```\n\n### Error Handling\n- Group already exists → idempotent (update if changed, skip if identical)\n- Invalid GID → fail with clear error\n- Not elevated → fail immediately\n- Group has members on delete → warning or fail (configurable)\n\n## Files to Create/Modify\n\n- `lua/syslua/group.lua` - Main module implementation\n- `lua/syslua/init.lua` - Export the new module\n- `docs/specs/2026-01-10-group-module-design.md` - Design specification\n- `docs/plans/2026-01-10-group-module-implementation.md` - Implementation plan\n- `crates/lib/tests/fixtures/group/` - Test fixtures\n\n## Acceptance Criteria\n\n- [ ] Cross-platform support (Linux, macOS, Windows)\n- [ ] CRUD operations for groups\n- [ ] Idempotent behavior using bind system\n- [ ] Type definitions with LuaLS annotations\n- [ ] Integration with priority module\n- [ ] Elevation check before operations\n- [ ] Clear error messages\n- [ ] Test fixtures created\n- [ ] Module exported from syslua init","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-10T15:41:55.352113-05:00","created_by":"ianpascoe","updated_at":"2026-01-12T11:23:44.039363-05:00","closed_at":"2026-01-12T11:23:44.039363-05:00","close_reason":"Group module implemented with full CRUD lifecycle"}
{"id":"syslua-8ji","title":"Fix sed -i portability for macOS in environment.packages","description":"macOS BSD sed needs 'sed -i \"\"' not 'sed -i.bak'. Current code fails on macOS. Use portable pattern: sed \u003e tmp \u0026\u0026 mv tmp file","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T19:20:42.113412-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:27:10.542626-05:00","closed_at":"2026-01-08T19:27:10.542626-05:00","close_reason":"Fixed in packages.lua: portable sed pattern, atomic swap, directory output handling"}
{"id":"syslua-8pv","title":"Implement ctx:patch_rpath() build helper","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T18:27:50.336007-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.723152-05:00","closed_at":"2026-01-08T18:35:11.723152-05:00","close_reason":"Superseded by new plan syslua-ffg"}
{"id":"syslua-8t3","title":"Document breaking change: build/bind outputs now use JsonValue","description":"Change from HashMap\u003cString, String\u003e to HashMap\u003cString, JsonValue\u003e is a significant API change. Add migration notes in release documentation.\n\nFile reference: crates/lib/src/execute/types.rs:121-133","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T15:37:27.395275-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:27.395275-05:00"}
{"id":"syslua-9fi","title":"Phase 5: ctx:patch_shebang() build helper","description":"Register ctx:patch_shebang() via sys.register_build_ctx_method(). Rewrites shebang lines in scripts to use specific interpreter from store. Works on all platforms. ~50 lines.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T18:34:52.937819-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:13:27.918324-05:00","closed_at":"2026-01-08T19:13:27.918324-05:00","close_reason":"Implemented in init.lua setup callback","dependencies":[{"issue_id":"syslua-9fi","depends_on_id":"syslua-b27","type":"blocks","created_at":"2026-01-08T18:34:58.921891-05:00","created_by":"ianpascoe"}]}
{"id":"syslua-b27","title":"Phase 1: Core symlink forest for environment.packages","description":"Create lua/syslua/environment/packages.lua with setup() API. Implement: package resolution with priority, binary discovery, symlink forest build, atomic swap bind, Windows fallback (junctions/hardlinks). ~300-400 lines.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-08T18:34:30.965386-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:11:09.853819-05:00","closed_at":"2026-01-08T19:11:09.853819-05:00","close_reason":"Implemented in lua/syslua/environment/packages.lua - 855 lines with full Phase 1 (symlink forest, collision resolution, Windows fallback) and Phase 2 (shell integration)"}
{"id":"syslua-bcr","title":"Phase 3: ctx:wrap_binary() build helper","description":"Register ctx:wrap_binary() via sys.register_build_ctx_method(). Creates wrapper scripts that set environment variables before executing real binary. Primary isolation mechanism on Windows. Templates for .sh and .cmd. ~100 lines.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-08T18:34:42.72229-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:13:27.914681-05:00","closed_at":"2026-01-08T19:13:27.914681-05:00","close_reason":"Implemented in init.lua setup callback","dependencies":[{"issue_id":"syslua-bcr","depends_on_id":"syslua-b27","type":"blocks","created_at":"2026-01-08T18:34:58.807458-05:00","created_by":"ianpascoe"}]}
{"id":"syslua-d5l","title":"Fix atomic swap in environment.packages","description":"ln -sfn is not atomic (unlinks then creates). Use temp symlink + mv pattern for true atomicity.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T19:20:43.706256-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:27:10.54556-05:00","closed_at":"2026-01-08T19:27:10.54556-05:00","close_reason":"Fixed in packages.lua: portable sed pattern, atomic swap, directory output handling"}
{"id":"syslua-d9a","title":"user module: passwords visible in process list via shell args","description":"Passwords passed through shell command strings are visible in `ps aux`. Should use stdin piping for chpasswd or heredoc patterns. SOPS integration planned but this is a security concern.\n\nFile reference: lua/syslua/user.lua","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-10T15:37:26.967623-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:26.967623-05:00"}
{"id":"syslua-dcy","title":"Plaintext password handling security","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T13:24:15.547343-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:44.105393-05:00","closed_at":"2026-01-10T13:24:44.105393-05:00","close_reason":"Deferred: Requires stdin support in Rust action framework"}
{"id":"syslua-dyu","title":"Phase 2: Shell integration for environment.packages","description":"Add shell_integration option that auto-adds ~/.syslua/bin to PATH in shell configs (bash, zsh, fish, PowerShell). Use markers pattern from environment/variables.lua. Handle opt-out with manual instructions. ~100 lines.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-08T18:34:36.626644-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:11:09.856569-05:00","closed_at":"2026-01-08T19:11:09.856569-05:00","close_reason":"Implemented in lua/syslua/environment/packages.lua - 855 lines with full Phase 1 (symlink forest, collision resolution, Windows fallback) and Phase 2 (shell integration)","dependencies":[{"issue_id":"syslua-dyu","depends_on_id":"syslua-b27","type":"blocks","created_at":"2026-01-08T18:34:58.749815-05:00","created_by":"ianpascoe"}]}
{"id":"syslua-e02","title":"user module: document group replacement behavior on update","description":"linux_update_user_cmd uses `-G` which replaces all supplementary groups. If a user was previously in groups not in the new config, they'll be removed silently. Document this behavior or add `-a` flag option.\n\nFile reference: lua/syslua/user.lua","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T15:37:27.496849-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:27.496849-05:00"}
{"id":"syslua-e4z","title":"Design CI/CD testing system for pkgs/programs/modules","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-08T07:07:22.730053-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T07:07:22.730053-05:00"}
{"id":"syslua-ffg","title":"[Epic] Implement syslua.environment.packages","description":"Implement environment.packages module per spec docs/specs/2026-01-08-environment-packages-design.md. Creates unified ~/.syslua/bin with symlinks to package binaries. Plan: docs/plans/2026-01-08-environment-packages-implementation.md","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-08T18:34:19.522383-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T19:13:34.53994-05:00","closed_at":"2026-01-08T19:13:34.53994-05:00","close_reason":"All phases implemented: environment.packages module (855 lines) + build context helpers (wrap_binary, patch_rpath, patch_shebang)"}
{"id":"syslua-fib","title":"Boolean output serialization bug","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T13:24:14.961356-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:30.906588-05:00","closed_at":"2026-01-10T13:24:30.906588-05:00","close_reason":"Fixed: Changed output type from BTreeMap\u003cString, String\u003e to BTreeMap\u003cString, JsonValue\u003e"}
{"id":"syslua-fkk","title":".expect() violations in paths.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T13:24:15.401136-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:43.996458-05:00","closed_at":"2026-01-10T13:24:43.996458-05:00","close_reason":"Deferred: Scope too large - requires updating 10+ caller files"}
{"id":"syslua-g6c","title":"Windows scheduled task race condition","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-10T13:24:15.106356-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:31.007267-05:00","closed_at":"2026-01-10T13:24:31.007267-05:00","close_reason":"Fixed: Replaced arbitrary 2-second sleep with task completion polling"}
{"id":"syslua-ieh","title":"Sequential group validation performance (O(n) shell spawns)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T13:24:15.256273-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:31.113588-05:00","closed_at":"2026-01-10T13:24:31.113588-05:00","close_reason":"Fixed: Batch group validation with single shell spawn via get_all_groups()"}
{"id":"syslua-k3g","title":"Implement ctx:wrap_binary() build helper","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T18:27:49.727306-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.728439-05:00","closed_at":"2026-01-08T18:35:11.728439-05:00","close_reason":"Superseded by new plan syslua-ffg"}
{"id":"syslua-ngn","title":"Missing unit tests for Lua helper functions","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-10T13:24:15.995422-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:44.309975-05:00","closed_at":"2026-01-10T13:24:44.309975-05:00","close_reason":"Deferred: New feature work requiring Lua test framework setup"}
{"id":"syslua-ooc","title":"Implement priority-based conflict resolution system","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2026-01-06T11:21:19.930233-05:00","created_by":"ianpascoe","updated_at":"2026-01-06T11:59:30.804082-05:00"}
{"id":"syslua-oph","title":"Implement programs module for system-binding packages","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2026-01-07T20:10:51.352473-05:00","created_by":"ianpascoe","updated_at":"2026-01-07T20:17:06.781779-05:00"}
{"id":"syslua-q7m","title":"user module: subprocess exit codes not captured for sys apply/destroy","description":"unix_run_as_user_cmd constructs shell commands but doesn't capture exit codes. If sys apply fails, the bind might still succeed. Add `|| exit 1` or capture/check exit codes.\n\nFile reference: lua/syslua/user.lua:3123-3133","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-10T15:37:27.0815-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:27.0815-05:00"}
{"id":"syslua-qox","title":"Priority System","description":"Plan and implement the syslua priority system for conflicting configuration values","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-05T16:26:16.15275-05:00","created_by":"ianpascoe","updated_at":"2026-01-06T11:23:52.013785-05:00","closed_at":"2026-01-06T11:23:52.013785-05:00","close_reason":"Closed"}
{"id":"syslua-snk","title":"Verify junction crate dependency exists for Windows link_dir","description":"link.rs references junction::create() but the Cargo.toml diff doesn't show the dependency being added. Verify it's already present or add `junction = \"1\"` to Windows dependencies.\n\nFile reference: crates/lib/src/platform/link.rs:78","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-10T15:37:27.294962-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T15:37:27.294962-05:00"}
{"id":"syslua-t7n","title":"Implement ctx:patch_shebang() build helper","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T18:27:50.904789-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.717971-05:00","closed_at":"2026-01-08T18:35:11.717971-05:00","close_reason":"Superseded by new plan syslua-ffg"}
{"id":"syslua-udb","title":"Two-phase destroy without rollback","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-10T13:24:15.694928-05:00","created_by":"ianpascoe","updated_at":"2026-01-10T13:24:44.207323-05:00","closed_at":"2026-01-10T13:24:44.207323-05:00","close_reason":"Deferred: Architectural limitation requiring transaction/checkpoint system"}
{"id":"syslua-wxy","title":"Implement environment.packages shell integration","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-08T18:27:49.0353-05:00","created_by":"ianpascoe","updated_at":"2026-01-08T18:35:11.732898-05:00","closed_at":"2026-01-08T18:35:11.732898-05:00","close_reason":"Superseded by new plan syslua-ffg","dependencies":[{"issue_id":"syslua-wxy","depends_on_id":"syslua-3dd","type":"blocks","created_at":"2026-01-08T18:27:57.708437-05:00","created_by":"ianpascoe"}]}
